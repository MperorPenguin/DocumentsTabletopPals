:root {
  --bg: #0f1524;
  --panel: #1b2436;
  --fg: #e4e8ef;
  --muted: #9da5b5;
  --yellow: #ffd84c;
  --teal: #44d9c0;
  --red: #f56565;
  --blue: #4da6ff;
  --purple: #a678ff;
  --sage: #7ad488;
  --btn-bg: #27344a;
  --btn-hover: #344866;
  --adv: #2e8b57;
  --dis: #b22222;
  --tip: #446688;
}

body {
  background: var(--bg);
  color: var(--fg);
  font-family: 'Segoe UI', Roboto, sans-serif;
  margin: 0;
  overflow-x: hidden;
}

h1,h2,h3 { margin: 0; font-weight: 600; }
.small { font-size: 13px; color: var(--muted); }
.mini { font-size: 12px; color: var(--muted); }

.hidden { display: none !important; }

/* ---------- Nav ---------- */
nav {
  position: sticky; top: 0; z-index: 10;
  background: #111827; padding: 8px; display: flex; gap: 8px;
}
nav button {
  background: var(--btn-bg); color: var(--fg);
  border: none; border-radius: 6px; padding: 6px 12px;
  cursor: pointer; transition: background .2s;
}
nav button.active { background: var(--blue); }
nav button:hover, nav button:focus { background: var(--btn-hover); outline: none; }

/* ---------- Panels / Tiles ---------- */
.panel {
  background: var(--panel);
  border-radius: 12px;
  padding: 12px;
  margin-bottom: 12px;
  box-shadow: 0 2px 5px rgba(0,0,0,.5);
}
.tile {
  cursor: pointer;
  transition: transform .15s, box-shadow .15s;
}
.tile:hover, .tile:focus {
  transform: translateY(-3px);
  box-shadow: 0 6px 12px rgba(0,0,0,.6);
  outline: none;
}
.chip {
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 6px;
  color: #111;
  margin-left: 6px;
}

/* ---------- Grid Layouts ---------- */
.grid-2 { display: grid; grid-template-columns: 2fr 1fr; gap: 12px; }
.grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap: 12px; }
.grid { display: grid; gap: 12px; }

/* ---------- Buttons ---------- */
.btn {
  background: var(--btn-bg); color: var(--fg);
  border: none; border-radius: 6px;
  padding: 6px 10px; cursor: pointer;
  transition: background .2s;
}
.btn:hover, .btn:focus { background: var(--btn-hover); outline: none; }
.btn.alt { background: #374151; }
.btn.tiny { font-size: 12px; padding: 2px 6px; }

/* ---------- Board + Tokens ---------- */
.board {
  position: relative;
  min-height: 480px;
  background-size: cover;
  background-position: center;
  border-radius: 8px;
  overflow: hidden;
}
.board .token {
  position: absolute;
  width: 40px; height: 40px;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid transparent;
  cursor: pointer;
  transition: transform .1s;
}
.board .token img { width: 100%; height: 100%; object-fit: contain; }
.board .token.selected { border-color: var(--yellow); transform: scale(1.1); }

/* ---------- DM Panel ---------- */
#dm-panel {
  position: fixed;
  right: 16px; top: 70px;
  width: 320px; max-height: calc(100vh - 90px);
  overflow-y: auto;
  background: var(--panel);
  border-radius: 12px;
  box-shadow: 0 4px 14px rgba(0,0,0,.6);
  padding: 12px;
  z-index: 20;
}
#dm-panel.hidden { display: none; }

.dm-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }

.dm-section { margin-top: 12px; }
.dm-list.grid.compact { display: grid; gap: 6px; }

.dm-card {
  display: flex; align-items: center;
  background: #202a3f;
  border-radius: 8px;
  padding: 6px;
}
.dm-card.pc { border-left: 4px solid var(--blue); }
.dm-card.enemy { border-left: 4px solid var(--red); }
.dm-avatar.sm { width: 28px; height: 28px; border-radius: 50%; overflow: hidden; margin-right: 6px; }
.dm-avatar.sm img { width: 100%; height: 100%; object-fit: contain; }
.dm-info { flex: 1; }
.dm-name { font-size: 14px; font-weight: 600; }

/* ---------- Terrain ---------- */
.terr-wrap { margin-top: 10px; display: flex; flex-direction: column; gap: 10px; }
.terr-group { }
.terr-head { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
.terr-head.tip { color: var(--tip); }
.terr-head.adv { color: var(--adv); }
.terr-head.dis { color: var(--dis); }

.terr-grid { display: flex; flex-wrap: wrap; gap: 6px; }
.terr-card {
  flex: 1 1 100%;
  background: #2b3650;
  border-radius: 6px;
  padding: 6px 8px;
  font-size: 13px;
  cursor: pointer;
  border: 2px solid transparent;
  text-align: left;
  transition: background .15s, border .15s;
}
.terr-card .dot { display:inline-block;width:8px;height:8px;border-radius:50%;margin-right:4px;vertical-align:middle; }
.terr-card.tip .dot { background: var(--tip); }
.terr-card.adv .dot { background: var(--adv); }
.terr-card.dis .dot { background: var(--dis); }
.terr-card:hover { background: #3b4765; }
.terr-card.active { border-color: var(--yellow); }

.dm-detail {
  background: #232f48;
  border-radius: 6px;
  padding: 8px;
  margin-top: 8px;
  font-size: 13px;
}

/* ---------- DM Floating FAB ---------- */
.dm-fab.btn {
  position: fixed;
  bottom: 16px; right: 16px;
  display: flex; align-items: center;
  background: var(--blue);
  color: #111;
  border-radius: 20px;
  padding: 6px 12px;
  font-size: 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,.4);
  z-index: 30;
}
.dm-fab-dot {
  width: 8px; height: 8px; border-radius: 50%; background: var(--yellow);
  margin-right: 6px;
}
.dm-fab-label { font-weight: 600; margin-right: 6px; }
.dm-fab-count {
  background: #111; color: #fff; font-size: 11px;
  border-radius: 10px; padding: 1px 6px;
}

/* ---------- Dice Calculator ---------- */
#dice-box {
  width: 60px; height: 60px;
  background: #222d44;
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 24px; font-weight: bold;
  margin-bottom: 8px;
}
#dice-box.roll { animation: shake .6s infinite; }
@keyframes shake {
  0%{transform:translate(0,0);} 25%{transform:translate(2px,-2px);} 50%{transform:translate(-2px,2px);} 75%{transform:translate(2px,2px);} 100%{transform:translate(0,0);}
}
.dice-controls { display: grid; grid-template-columns: repeat(3,1fr); gap: 6px; margin-top: 8px; }
.dice-controls button { padding: 10px; font-size: 14px; }
.dice-log { margin-top: 8px; font-size: 13px; color: var(--muted); max-height: 120px; overflow-y: auto; }
.dice-log div { margin-bottom: 4px; }

/* ---------- Responsive ---------- */
@media(max-width:1000px){
  .grid-2 { grid-template-columns: 1fr; }
  #dm-panel { width: 90%; right: 5%; }
}
@media(max-width:600px){
  nav { flex-wrap: wrap; }
  #dm-panel { width: 100%; right: 0; top: 60px; border-radius: 0; }
}
