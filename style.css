:root{
  /* === Brand tokens (official names) === */
  --lime-green: #d6ed17;      /* Lime Green */
  --midnight-blue: #000e1b;   /* Midnight Blue */

  /* Tones */
  --lime-600:#c6de10;
  --lime-700:#a7c60e;

  /* App text + borders */
  --text:#e9ecf1;
  --border:#23283a;

  /* === Legacy aliases (keep old code working) === */
  --midnight: var(--midnight-blue);
  --lime: var(--lime-green);

  /* Backgrounds (midnight derived) */
  --bg: #000e1b;
  --panel: #041120;
  --panel-2: #081a2c;

  /* Accents / focus ring (always Lime Green) */
  --accent: var(--lime-green);

  /* Text shades */
  --ink: var(--text);
  --muted: #9bb6d6;

  /* Controls */
  --btn-min-h: 40px;
  --pad-y: 10px;
  --pad-x: 14px;

  /* Type scale (clamp keeps it responsive without jumps) */
  --fs-sm: clamp(12px, 1.6vw, 13px);
  --fs-base: clamp(13px, 1.8vw, 15px);
  --fs-btn: clamp(12px, 1.8vw, 14px);
  --fs-h2: clamp(16px, 3.2vw, 22px);
  --fs-h3: clamp(14px, 2.4vw, 18px);

  --radius: 12px;
}

/* Base */
*{ box-sizing:border-box }
html,body{ height:100% }
html{ -webkit-text-size-adjust:100%; text-size-adjust:100%; }
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family: "Arvo", Georgia, serif;
  font-size: var(--fs-base); line-height:1.5;
  overflow-wrap: anywhere;
}
.hidden{ display:none !important; } /* more robust for view toggling */
h1,h2,h3{ margin:0 0 8px }
h2{ font-size: var(--fs-h2); }
h3{ font-size: var(--fs-h3); }
.small{ font-size:var(--fs-sm); color:var(--muted) }

/* Top bar / nav */
.top{ position:sticky; top:0; z-index:50; backdrop-filter:blur(8px); background:#000e1bcc; border-bottom:1px solid var(--border) }
.top .inner{ max-width:1280px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; height:56px; padding:0 16px }
.logo{ display:flex; gap:8px; align-items:center }
.mark{ width:28px; height:28px; border-radius:8px; background:linear-gradient(135deg, var(--lime-green), var(--lime-green)) }

.nav{ display:flex; gap:8px; overflow:auto; -ms-overflow-style:none; scrollbar-width:none; }
.nav::-webkit-scrollbar{ display:none; }
.nav button{
  appearance:none; background:var(--lime-green); border:1px solid transparent; color:var(--midnight-blue);
  cursor:pointer; border-radius:10px; padding:8px 12px; font-weight:800; min-height: var(--btn-min-h);
}
.nav button:hover{ background:var(--lime-600) }
.nav button:active{ background:var(--lime-700) }

/* Page wrapper */
main{ max-width:1280px; margin: 12px auto; padding: 0 12px }

/* Panel */
.panel{ background: var(--panel); border:1px solid var(--border); border-radius: 14px; box-shadow: 0 8px 24px rgba(0,0,0,.42); padding: 12px; }
.section-head{ display:flex; align-items:center; justify-content:space-between; gap:10px }

/* Home grid + tiles */
.home-grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:12px; }
@media (max-width: 640px){ .home-grid{ grid-template-columns: 1fr; } }
.panel.tile{ display:block; text-align:center; border:1px solid var(--border); border-radius:12px; padding:14px; margin-top:12px; }
.panel.tile{
  cursor:pointer;
  transition: transform .15s, box-shadow .15s, border-color .15s, background-color .15s;
  outline: none;
}

/* Home: brand hero */
.hero-panel{
  max-width: 520px;
  margin: 0 auto 14px;
  padding: 14px;
  display: grid;
  place-items: center;
}
.brand-logo{
  display:block;
  width: min(360px, 80vw);
  height: auto;
  border-radius: 12px;
  background: var(--midnight-blue);
  border: 1px solid var(--border);
  box-shadow: 0 8px 28px rgba(0,0,0,.45);
}

/* World */
.control-row{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
.board-ctrl{
  display:inline-flex; align-items:center; gap:6px;
  padding: var(--pad-y) var(--pad-x); border-radius:12px;
  background:var(--lime-green); border:1px solid transparent; color:var(--midnight-blue);
  cursor:pointer; transition:.15s; font-size: var(--fs-btn); min-height: var(--btn-min-h);
  max-width:100%; white-space:normal; text-align:center; line-height:1.25;
}
.board-ctrl:hover{
  background:var(--lime-600);
  box-shadow:0 0 0 2px rgba(214,237,23,.25) inset;
}

/* Shared pill/button look (env + map selectors) */
.pill, .map-pill, .env-pill{
  appearance:none; background:var(--lime-green); border:1px solid transparent; color:var(--midnight-blue);
  cursor:pointer; border-radius:999px; padding:6px 10px; font-weight:800; min-height: var(--btn-min-h);
}
.pill:hover, .map-pill:hover, .env-pill:hover{ background:var(--lime-600) }
.map-pill.active, .env-pill.active{ background:var(--midnight-blue); color:#dbe1ee; border-color: var(--border) }

.world-stage{
  display:grid; place-items:center; min-height: 50vh; background: var(--midnight-blue); border:1px solid var(--border); border-radius: 12px; padding: 8px;
}
.world-stage.fit .world-img{
  max-width: min(100%, 1280px);
  max-height: 85vh;
  object-fit: contain;
}
.world-stage.actual .world-img{
  max-width: none;
  max-height: none;
  width: auto;
  height: auto;
  image-rendering: auto;
  max-width:100%;
}
.world-stage .world-img,
.world-img{
  display:block;
  width:auto;
  height:auto;
  max-width:min(100%, 1280px);
  max-height:85vh;
  object-fit:contain;
  background:var(--midnight-blue);
}

/* DM page */
.dm-page{ background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:10px; }
.dm-head{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:6px; border-bottom:1px solid var(--border); padding-bottom:6px;
}

/* Tabs: scroll on mobile (no squeezing), wrap on wide screens */
.dm-tabs{
  display:flex; gap:6px; margin:6px 0 8px 0;
  overflow:auto; -ms-overflow-style:none; scrollbar-width:none; flex-wrap:nowrap;
}
.dm-tabs::-webkit-scrollbar{ display:none; }
@media (min-width: 900px){
  .dm-tabs{ flex-wrap:wrap; }
}
.dm-tab{
  appearance:none; background:var(--lime-green); border:1px solid transparent; color:var(--midnight-blue);
  cursor:pointer; border-radius:999px; padding:6px 10px; font-weight:800; min-height: var(--btn-min-h);
  font-size: var(--fs-btn);
}
.dm-tab:hover{ background:var(--lime-600) }
.dm-tab.active{ background: var(--midnight-blue); color:#dbe1ee; border:1px solid var(--border) }

/* DM grid + cards */
.dm-grid3{
  display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:10px;
}
@media (max-width: 900px){
  .dm-grid3{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}
@media (max-width: 560px){
  .dm-grid3{ grid-template-columns: 1fr; }
}
.dm-card{
  background: var(--panel-2); border:1px solid var(--border); border-radius: 12px; padding: 10px;
}
.dm-card.selected{ outline: 2px solid var(--accent); outline-offset: 2px; }

.avatar img{ width:42px; height:42px; }

.badges{ display:flex; gap:6px; flex-wrap:wrap; margin-top:6px }
.badge{
  display:inline-flex; align-items:center; gap:6px;
  background: var(--midnight-blue); color:#dbe1ee; border:1px solid var(--border);
  font-size: clamp(10px, 1.9vw, 11.5px); padding:3px 8px; border-radius:999px;
  border:1px solid var(--border); background:var(--midnight-blue); color:#dbe1ee;
}

.dm-title-btn{
  appearance:none; display:inline-flex; align-items:center; gap:8px; border-radius:999px; border:1px solid transparent;
  padding: var(--pad-y) var(--pad-x); font-size: var(--fs-btn); font-weight:800; cursor:pointer; user-select:none; transition:.15s;
  width:auto; justify-content:center; text-align:center; background:var(--lime-green); color:var(--midnight-blue); min-height: var(--btn-min-h);
  max-width:100%;
}
.dm-title-btn:hover{ background:var(--lime-600); }
.dm-title-btn.short{ display:inline-flex; align-items:center; justify-content:center; padding:8px; min-width:38px; height:38px; line-height:1; }
/* semantic colours */
.dm-title-btn.adv{ background:#065f46; color:#d1fae5; border-color:#0b7a5b }
.dm-title-btn.dis{ background:#7f1d1d; color:#fee2e2; border-color:#9b2222 }
.dm-character-box > .dm-actions{ display:flex; gap:6px; margin-top:6px; justify-content:center; align-items:center; }

/* Quick dice inside DM tools */
.quick-dice-row{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px }
.quick-die-btn{
  display:inline-flex; align-items:center; gap:8px; padding: var(--pad-y) var(--pad-x); border-radius:12px;
  background:var(--lime-green); border:1px solid transparent; cursor:pointer; color:var(--midnight-blue); transition:.15s; user-select:none;
  font-size: var(--fs-btn); min-height: var(--btn-min-h); max-width:100%;
}
.quick-die-btn:hover{
  background: var(--lime-600);
  box-shadow:0 0 0 2px rgba(214,237,23,.22) inset;
}

/* Notes textarea (app + DM) */
textarea{
  width:100%; min-height:240px;
  background: var(--panel-2); color: var(--ink); border:1px solid var(--border); border-radius:12px; padding:10px 12px;
}

/* Dice shared */
.dice-hero{ display:grid; place-items:center; margin:6px 0 10px; color:var(--accent) }
.dice-hero img{ width: 64px; height: 64px; opacity:.9 }
.dice-row{ display:flex; gap:8px; flex-wrap:wrap }
.die-btn{
  appearance:none; background:var(--lime-green); color:var(--midnight-blue); cursor:pointer; border:1px solid transparent;
  border-radius:12px; padding:10px 12px; font-weight:800; min-height: var(--btn-min-h);
}
.die-btn:hover{ background:var(--lime-600) }
.die-btn:active{ background:var(--lime-700) }

.dice-ops{ display:flex; gap:8px; margin-top:8px; flex-wrap:wrap }
.btn{
  appearance:none; background:var(--lime-green); color:var(--midnight-blue); cursor:pointer; border:1px solid transparent;
  border-radius:12px; padding:10px 12px; font-weight:800; min-height: var(--btn-min-h);
}
.btn:hover{ background:var(--lime-600) }
.btn.ghost{ background: var(--midnight-blue); color: var(--ink); border:1px solid var(--border) }
.btn.ghost:hover{ background:#001a2c }

/* Roll output */
.roll-output{ margin-top: 10px }
.roll-card{
  border:1px solid var(--border); border-radius:12px; padding:10px 12px; background: var(--panel-2);
}
.roll-total{ font-weight:900; font-size: clamp(20px, 4vw, 36px); line-height:1 }
.roll-breakdown{ color: var(--muted); margin-top: 2px }

/* Toast */
.dm-toast{
  position: fixed; top: 14px; right: 14px; z-index: 1000;
  background: var(--midnight-blue); border:1px solid var(--border); color: var(--text);
  border-radius: 12px; padding: 10px 12px; min-width: 180px; max-width: 520px;
  box-shadow: 0 8px 24px rgba(0,0,0,.42);
}
.dm-toast h4{ margin:0 0 4px; font-size:13px; font-weight:800 }
.dm-toast .msg { white-space: pre-wrap; }
.dm-toast .close{
  position:absolute; top:8px; right:10px; cursor:pointer; opacity:.7;
  line-height:1; font-weight:900; user-select:none;
}
.dm-toast .close:hover{ opacity:1 }
.dm-toast .close:focus-visible{ outline:2px solid var(--accent); outline-offset:2px; border-radius:4px; }

/* Section heads */
.section-head h2{ margin:0 0 6px; }

/* Accessible focus rings (global) */
:where(.btn,.board-ctrl,.pill,.map-pill,.env-pill,.die-btn,.dm-tab,.dm-title-btn):focus-visible{
  outline:2px solid var(--accent);
  outline-offset:2px;
}

/* Smooth view entry */
.view-anim{ animation: fadeSlideIn .24s ease both; }
@keyframes fadeSlideIn{ from{ opacity:0; transform: translateY(6px); } to{ opacity:1; transform: translateY(0); } }

/* Hover/focus for ANY home tile */
.tile:focus-visible, .panel.tile:focus-visible {
  border-color: var(--lime-green);
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}
.tile:hover, .panel.tile:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(0,0,0,.35);
  border-color: var(--lime-green);
}

/* Home tile for Encounters */
.tile-home-encounters {
  background:
    linear-gradient(180deg, rgba(214,237,23,0.12), rgba(0,0,0,0)),
    var(--midnight-blue);
  border: 1px solid var(--border);
}
.tile-home-encounters:hover { box-shadow: 0 0 0 2px rgba(214,237,23,.25) inset; }
