<!-- DMToolkit v2.2.0 | index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>DM Toolkit</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Top bar -->
  <div class="top">
    <div class="inner">
      <div class="logo">
        <div class="mark"></div>
        <strong>DM Toolkit</strong>
      </div>
      <div class="nav">
        <button id="nav-home"   onclick="nav('home')">Home</button>
        <button id="nav-board"  onclick="nav('board')">Board</button>
        <button id="nav-dice"   onclick="nav('dice')">Dice</button>
        <button id="nav-notes"  onclick="nav('notes')">Notes</button>
      </div>
    </div>
  </div>

  <main>
    <!-- HOME -->
    <section id="view-home">
      <div class="panel tile tile-home-board" tabindex="0" onclick="nav('board')">
        <h2>Battle Board</h2>
        <div class="small">26Ã—26 grid, tokens, fullscreen &amp; pop-out. Maps from <code>assets/maps/index.json</code> (PNG/SVG).</div>
      </div>
      <div class="panel tile tile-home-dice" tabindex="0" onclick="nav('dice')">
        <h2>Dice</h2>
        <div class="small">Quick multi-die rolling.</div>
      </div>
      <div class="panel tile tile-home-notes" tabindex="0" onclick="nav('notes')">
        <h2>Notes</h2>
        <div class="small">Campaign/session notes.</div>
      </div>
    </section>

    <!-- BOARD -->
    <section id="view-board" class="hidden">
      <h2>Board</h2>

      <!-- control bar ABOVE the map, right aligned -->
      <div class="board-control-wrap">
        <div id="board-controls" class="board-control-bar">
          <button class="board-ctrl" onclick="toggleBoardFullscreen()">Full</button>
          <button class="board-ctrl" onclick="openBoardViewer()">Pop-out</button>
        </div>
      </div>

      <div id="board" class="board" style="margin-top:10px" onclick="boardClick(event)"></div>

      <div class="small" style="margin-top:8px">
        Tip: Click a token to select it, then click a grid cell to move. Press <b>Shift+D</b> to toggle the DM Panel.
      </div>
    </section>

    <!-- DICE -->
    <section id="view-dice" class="hidden">
      <h2>Dice</h2>
      <div class="panel">
        <div id="dice-buttons" class="dice-row"></div>
        <div style="margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <div id="dice-selection" class="small">No dice selected</div>
          <button class="btn btn-xl" onclick="rollAll()">Roll</button>
          <button class="btn btn-xl" onclick="clearDice()">Clear</button>
        </div>
        <div id="dice-output" class="roll-output" style="margin-top:12px"></div>
      </div>
    </section>

    <!-- NOTES (page) -->
    <section id="view-notes" class="hidden">
      <h2>Notes</h2>
      <div class="panel">
        <textarea id="notes" rows="12" style="width:100%"></textarea>
      </div>
    </section>
  </main>

  <footer>
    <div class="small">Local, offline-friendly DM toolkit. Maps loaded from <code>assets/maps/index.json</code> (PNG/SVG).</div>
  </footer>

  <!-- DM Panel -->
  <div id="dm-panel" class="dm-panel hidden"></div>

  <!-- DM FAB -->
  <button id="dm-fab" class="dm-fab" onclick="maximizeDmPanel()">
    <span class="dm-fab-dot"></span>
    <span class="dm-fab-label">DM Panel</span>
    <span id="dm-fab-count" class="dm-fab-count">0</span>
  </button>

  <!-- Safe fallback shim: if user clicks before app.js is ready, store the route -->
  <script>
    window.nav = window.nav || function(route){ window.__pendingNav = route; };
  </script>

  <!-- Make sure this tag is NOT type="module" so globals (nav, maximizeDmPanel, etc.) are exported -->
  <script src="app.js"></script>

  <!-- After app.js loads, apply any pending nav -->
  <script>
    if (window.__pendingNav && typeof window.nav === 'function') {
      window.nav(window.__pendingNav);
      window.__pendingNav = null;
    }
  </script>
</body>
</html>
