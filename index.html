<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>DM Toolkit</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Top bar -->
  <div class="top">
    <div class="inner">
      <div class="logo">
        <div class="mark"></div>
        <strong>DM Toolkit</strong>
      </div>
      <div class="nav">
        <button id="nav-home"  onclick="nav('home')">Home</button>
        <button id="nav-world" onclick="nav('world')" class="">World Map</button>
        <button id="nav-dice"  onclick="nav('dice')">Dice</button>
        <button id="nav-notes" onclick="nav('notes')">Notes</button>
        <button id="nav-dm"    onclick="nav('dm')">DM</button>
      </div>
    </div>
  </div>

  <main>
    <!-- HOME -->
    <section id="view-home">
      <div class="home-grid">
        <div class="panel tile tile-home-world" tabindex="0" onclick="nav('world')"><h2>World Map</h2></div>
        <div class="panel tile tile-home-dice"  tabindex="0" onclick="nav('dice')"><h2>Dice</h2></div>
        <div class="panel tile tile-home-dm"    tabindex="0" onclick="nav('dm')"><h2>DM</h2></div>
        <div class="panel tile tile-home-notes" tabindex="0" onclick="nav('notes')"><h2>Notes</h2></div>
      </div>
    </section>

    <!-- WORLD MAP -->
    <section id="view-world" class="hidden">
      <div class="panel">
        <div class="section-head"><h2>World Map</h2></div>
        <div class="control-row">
          <button class="board-ctrl" onclick="toggleWorldFullscreen()">Fullscreen</button>
          <button class="board-ctrl" onclick="openWorldViewer()">Cast / Pop-out</button>
        </div>
        <div id="world" class="world-stage" style="margin-top:10px"></div>
      </div>

      <div class="panel" style="margin-top:10px">
        <div class="section-head"><h3>Select Map</h3></div>
        <div id="world-map-list" class="map-list"></div>
      </div>
    </section>

    <!-- DICE -->
    <section id="view-dice" class="hidden">
      <div class="panel">
        <div class="section-head"><h2>Dice</h2></div>
        <div id="dice-buttons" class="dice-row"></div>

        <div style="margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <div id="dice-selection" class="small"></div>
          <button class="btn btn-xl" onclick="rollAll()">Roll</button>
          <button class="btn btn-xl" onclick="clearDice()">Clear</button>
        </div>

    <div class="dice-hero" style="color:#A78BFA">
  <svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <linearGradient id="arcane-fill" x1="0" y1="0" x2="0" y2="1">
        <stop offset="0" stop-color="#B79CFF"/>
        <stop offset="1" stop-color="#5FB4FF"/>
      </linearGradient>
      <radialGradient id="arcane-shine" cx="50%" cy="38%" r="65%">
        <stop offset="0" stop-color="#ffffff" stop-opacity=".25"/>
        <stop offset="1" stop-color="#000000" stop-opacity="0"/>
      </radialGradient>
      <filter id="arcane-shadow" x="-50%" y="-50%" width="200%" height="200%">
        <feDropShadow dx="0" dy="3" stdDeviation="2.6" flood-opacity=".45"/>
      </filter>
      <clipPath id="arcane-clip">
        <polygon points="24,4 40,12 44,24 32,40 16,40 4,24 8,12"/>
      </clipPath>
      <style>.ink{stroke:#e9ecf1}</style>
    </defs>

    <g filter="url(#arcane-shadow)">
      <polygon fill="url(#arcane-fill)" points="24,4 40,12 44,24 32,40 16,40 4,24 8,12"/>
      <rect x="0" y="0" width="48" height="48" fill="url(#arcane-shine)" clip-path="url(#arcane-clip)"/>
      <polygon fill="none" class="ink" stroke-width="2.1" stroke-linejoin="round"
               points="24,4 40,12 44,24 32,40 16,40 4,24 8,12"/>
    </g>

    <g fill="none" class="ink" stroke-width="1.8" stroke-linejoin="round" stroke-linecap="round">
      <path d="M24 4 L8 12 L24 24 L40 12 Z"/>
      <path d="M8 12 L40 12 M4 24 L44 24"/>
      <path d="M16 40 L24 24 L32 40"/>
      <path d="M4 24 L16 40 L32 40 L44 24"/>
    </g>

    <g fill="#ffffff" opacity=".7">
      <path d="M30 10 l1.2 2.4 2.4 1.2 -2.4 1.2 -1.2 2.4 -1.2-2.4 -2.4-1.2 2.4-1.2z"/>
      <path d="M14 28 l0.9 1.8 1.8 0.9 -1.8 0.9 -0.9 1.8 -0.9-1.8 -1.8-0.9 1.8-0.9z" opacity=".6"/>
    </g>

    <g fill="#0f1115" font-family="system-ui, Segoe UI, Roboto, Arial, sans-serif" font-weight="900">
      <text x="24" y="15" font-size="9"  text-anchor="middle">20</text>
      <text x="24" y="29" font-size="16" text-anchor="middle">8</text>
      <text x="16" y="34" font-size="10" text-anchor="middle">4</text>
      <text x="32" y="34" font-size="10" text-anchor="middle">4</text>
      <text x="10" y="26" font-size="9"  text-anchor="middle">8</text>
      <text x="38" y="26" font-size="9"  text-anchor="middle">1</text>
    </g>
  </svg>
</div>

          <div class="roll-card">
            <div class="roll-total">—</div>
            <div class="roll-breakdown">Add dice to roll…</div>
          </div>
        </div>
      </div>
    </section>

    <!-- NOTES -->
    <section id="view-notes" class="hidden">
      <div class="panel">
        <div class="section-head"><h2>Notes</h2></div>
        <textarea id="app-notes" rows="14" style="width:100%"></textarea>
      </div>
    </section>

    <!-- DM (full page) -->
    <section id="view-dm" class="hidden">
      <div class="dm-page panel">
        <div class="dm-head">
          <h3>DM</h3>
          <div class="dm-head-actions">
            <button class="btn tiny" onclick="nav('home')">Back to Home</button>
          </div>
        </div>
        <div id="dm-tabs" class="dm-tabs"></div>
        <div id="dm-body"></div>
      </div>
    </section>
  </main>

  <!-- Rescue nav if app.js fails to load -->
  <script>
    (function(){
      function navRescue(route){
        var views = ['home','world','dice','notes','dm'];
        for (var i=0;i<views.length;i++){
          var v = views[i];
          var main = document.getElementById('view-'+v);
          var btn  = document.getElementById('nav-'+v);
          if(!main || !btn) continue;
          if(v===route){ main.classList.remove('hidden'); btn.classList.add('active'); }
          else{ main.classList.add('hidden'); btn.classList.remove('active'); }
        }
      }
      window.nav = window.nav || navRescue;
    })();
  </script>

  <script src="app.js"></script>
  <script>
    // Boot
    if (window.__pendingNav && typeof window.nav === 'function') {
      window.nav(window.__pendingNav);
      window.__pendingNav = null;
    } else {
      nav('home');
    }
  </script>
</body>
</html>
